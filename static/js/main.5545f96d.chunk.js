(this["webpackJsonpwebim-users-task"]=this["webpackJsonpwebim-users-task"]||[]).push([[0],{124:function(e,a,t){e.exports=t(166)},165:function(e,a,t){},166:function(e,a,t){"use strict";t.r(a);var n,r=t(0),s=t.n(r),c=t(23),u=t.n(c),l=t(14),o=t(47),i=t(71),m=t.n(i),d=t(31),h=t(6),p=t.n(h),f=t(15),v=t(46),b=t.n(v);!function(e){e.AuthToken="http://emphasoft-test-assignment.herokuapp.com/api-token-auth/",e.Users="http://emphasoft-test-assignment.herokuapp.com/api/v1/users"}(n||(n={}));var E=function(){var e=Object(f.a)(p.a.mark((function e(a){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.a.post(n.AuthToken,a).then((function(e){return e.data.token}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(a){return e.apply(this,arguments)}}(),g=function(){var e=Object(f.a)(p.a.mark((function e(a){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.a.get("".concat(n.Users,"/"),{headers:{Authorization:"Token ".concat(a)}}).then((function(e){return e.data}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(a){return e.apply(this,arguments)}}(),U=function(){var e=Object(f.a)(p.a.mark((function e(a,t){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.a.post("".concat(n.Users,"/"),a,{headers:{Authorization:"Token ".concat(t),"Content-Type":"application/json"}}).then((function(e){return e.data}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(a,t){return e.apply(this,arguments)}}(),y=function(){var e=Object(f.a)(p.a.mark((function e(a,t,r){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.a.put("".concat(n.Users,"/").concat(a,"/"),t,{headers:{Authorization:"Token ".concat(r),"Content-Type":"application/json"}}).then((function(e){return e.data}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(a,t,n){return e.apply(this,arguments)}}(),w=function(){var e=Object(f.a)(p.a.mark((function e(a,t,r){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.a.patch("".concat(n.Users,"/").concat(a,"/"),t,{headers:{Authorization:"Token ".concat(r),"Content-Type":"application/json"}}).then((function(e){return e.data}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(a,t,n){return e.apply(this,arguments)}}(),k=function(){var e=Object(f.a)(p.a.mark((function e(a,t){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,b.a.delete("".concat(n.Users,"/").concat(a,"/"),{headers:{Authorization:"Token ".concat(t)}}).then((function(){return a}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(a,t){return e.apply(this,arguments)}}(),x=Object(o.b)({name:"auth",initialState:{isAuthenticated:!1,token:null,isLoading:!1,error:null,user:null},reducers:{authStart:function(e){e.isLoading=!0},authSucess:function(e,a){var t=a.payload;e.isLoading=!1,e.error=null,e.isAuthenticated=!0,e.token=t,m.a.set("token",t)},deauthenticate:function(e){e.isAuthenticated=!1,e.token=null,m.a.remove("token")},authFailure:function(e,a){e.isLoading=!1,e.error=a.payload}}}),S=x.reducer,C=x.actions,j=C.authStart,F=C.authSucess,N=C.authFailure,O=C.deauthenticate;function I(e){e.isLoading=!0}function A(e,a){e.isLoading=!1,e.error=a.payload}var L=Object(o.b)({name:"users",initialState:{usersById:{},allIds:[],isLoading:!1,error:null},reducers:{getUserStart:I,getUsersStart:I,postUserStart:I,putUserStart:I,patchUserStart:I,deleteUserStart:I,getUserSuccess:function(e,a){var t=a.payload,n=t.id;e.usersById[n]=t,e.isLoading=!1,e.error=null},getUsersSuccess:function(e,a){var t=a.payload;e.isLoading=!1,e.error=null,t.forEach((function(a){e.usersById[a.id]=a,e.allIds.push(a.id)}))},postUserSucess:function(e,a){var t=a.payload,n=t.id;e.isLoading=!1,e.error=null,e.usersById[n]=t,e.allIds.push(n)},putUserSucess:function(e,a){var t=a.payload,n=t.id;e.isLoading=!1,e.error=null,e.usersById[n]=t},patchUserSucess:function(e,a){var t=a.payload,n=t.id;e.isLoading=!1,e.error=null,e.usersById[n]=t},deleteUserSucess:function(e,a){var t=a.payload;e.isLoading=!1,e.error=null,delete e.usersById[t],e.allIds.splice(e.allIds.findIndex((function(e){return e===t})),1)},getUserFailure:A,getUsersFailure:A,postUserFailure:A,putUserFailure:A,patchUserFailure:A,deleteUserFailure:A}}),P=L.actions,T=P.getUsersStart,B=P.getUsersSuccess,_=(P.getUserStart,P.getUserSuccess,P.postUserStart),G=P.postUserSucess,V=P.putUserStart,D=P.putUserSucess,q=P.patchUserStart,z=P.patchUserSucess,H=P.deleteUserStart,$=P.deleteUserSucess,J=(P.getUserFailure,P.getUsersFailure),Z=P.postUserFailure,M=P.putUserFailure,K=P.patchUserFailure,Q=P.deleteUserFailure,R=L.reducer,W=Object(d.c)({auth:S,users:R}),X=m.a.get("token"),Y=Object(o.a)({reducer:W,preloadedState:{auth:{isAuthenticated:!!X,token:X}}}),ee=t(9),ae=t(65),te=t(16),ne=t(169),re=t(117),se=t(177),ce=t(170),ue=t(175),le=t(171),oe=te.b({username:te.c().required().min(1,"*Username must have at least 1 character").max(150,"*Username can't be longer than 100 characters").matches(/^[\w.@+-]+$/,"*Username is not valid"),password:te.c().required().min(8,"*Password must have at least 8 character").max(128,"*Password can't be longer than 128 characters").matches(/^(?=.*[A-Z])(?=.*\d)/,"*Password is not valid")}),ie=function(){var e=Object(l.b)(),a=Object(ee.f)(),t=Object(l.c)((function(e){return e.auth})),n=t.error,r=t.isAuthenticated,c=Object(ae.a)({initialValues:{username:"",password:""},validationSchema:oe,onSubmit:function(t,r){var s,c=r.resetForm;Promise.resolve(e((s=t,function(){var e=Object(f.a)(p.a.mark((function e(a){var t;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a(j()),e.next=4,E(s);case 4:t=e.sent,a(F(t)),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(0),a(N(e.t0.message));case 11:case"end":return e.stop()}}),e,null,[[0,8]])})));return function(a){return e.apply(this,arguments)}}()))).then((function(){return c()})).then((function(){n||a.push("/")}))}});if(r)return s.a.createElement(ee.a,{to:"/"});return s.a.createElement(ne.a,{as:"section",className:"h-100"},s.a.createElement(re.a,{xl:4,lg:6,md:8,sm:8,className:"m-auto"},s.a.createElement(se.a,null,s.a.createElement(se.a.Body,null,s.a.createElement(se.a.Title,{as:"h3"},"Sign in"),n&&s.a.createElement(ce.a,{variant:"danger"},n),s.a.createElement(ue.a,{noValidate:!0,onSubmit:function(e){c.handleSubmit(e)}},s.a.createElement(ue.a.Group,{controlId:"username"},s.a.createElement(ue.a.Label,null,"Username"),s.a.createElement(ue.a.Control,{type:"text",placeholder:"Enter username",name:"username",onChange:c.handleChange,value:c.values.username,isInvalid:!!c.errors.username,autoFocus:!0}),s.a.createElement(ue.a.Control.Feedback,{type:"invalid"},c.errors.username)),s.a.createElement(ue.a.Group,{controlId:"password"},s.a.createElement(ue.a.Label,null,"Password"),s.a.createElement(ue.a.Control,{type:"password",placeholder:"Password",name:"password",onChange:c.handleChange,value:c.values.password,isInvalid:!!c.errors.password}),s.a.createElement(ue.a.Control.Feedback,{type:"invalid"},c.errors.password)),s.a.createElement(le.a,{variant:"primary",type:"submit",disabled:!(c.isValid&&c.dirty)||c.isSubmitting},"Submit"))))))},me=t(66),de=t(103),he=(t(163),t(173)),pe=t(174),fe=te.b({username:te.c().required().min(1,"*Username must have at least 1 character").max(150,"*Username can't be longer than 100 characters").matches(/^[\w.@+-]+$/,"*Username is not valid"),firstName:te.c().max(30,"*First name can't be longer than 30 characters"),lastName:te.c().max(150,"*Last name can't be longer than 30 characters"),isActive:te.a().required()}),ve=function(e){var a=e.user,t=(e.handlePutUser,e.handlePatchUser),n=Object(r.useState)({username:a.username,firstName:a.first_name,lastName:a.last_name,isActive:a.is_active}),c=Object(me.a)(n,2),u=c[0],l=c[1],o=Object(ae.a)({initialValues:u,validationSchema:fe,onSubmit:function(e,n){var r=n.setSubmitting,s=n.setStatus,c=(n.setValues,{username:e.username,first_name:e.firstName,last_name:e.lastName,is_active:e.isActive});Promise.resolve(t(a.id,c)).then((function(){return s({type:"sucess",username:e.username})})).then((function(){return l(e)})).then((function(){setTimeout((function(){r(!1),s("pending")}),2500)}))}}),i=o.status&&"sucess"===o.status.type;return s.a.createElement(s.a.Fragment,null,i&&s.a.createElement(ce.a,{variant:"success"},"User ",s.a.createElement("b",null,o.status.username)," was updated"),s.a.createElement(ue.a,{noValidate:!0,onSubmit:function(e){o.handleSubmit(e)}},s.a.createElement(ue.a.Group,{controlId:"username"},s.a.createElement(ue.a.Label,null,"Username"),s.a.createElement(ue.a.Control,{type:"text",placeholder:"Enter username",name:"username",onChange:o.handleChange,value:o.values.username,isInvalid:!!o.errors.username,autoFocus:!0}),s.a.createElement(ue.a.Control.Feedback,{type:"invalid"},o.errors.username)),s.a.createElement(ue.a.Group,{controlId:"firstName"},s.a.createElement(ue.a.Label,null,"First name"),s.a.createElement(ue.a.Control,{type:"text",placeholder:"Enter first name",name:"firstName",onChange:o.handleChange,value:o.values.firstName,isInvalid:!!o.errors.firstName}),s.a.createElement(ue.a.Control.Feedback,{type:"invalid"},o.errors.firstName)),s.a.createElement(ue.a.Group,{controlId:"lastName"},s.a.createElement(ue.a.Label,null,"Last name"),s.a.createElement(ue.a.Control,{type:"text",placeholder:"Enter last name",name:"lastName",onChange:o.handleChange,value:o.values.lastName,isInvalid:!!o.errors.lastName}),s.a.createElement(ue.a.Control.Feedback,{type:"invalid"},o.errors.lastName)),s.a.createElement(ue.a.Group,{controlId:"active"},s.a.createElement(ue.a.Check,{type:"checkbox",label:"Active",name:"isActive",onChange:o.handleChange,checked:o.values.isActive}),s.a.createElement(ue.a.Text,{className:"text-muted"},"Designates whether this user should be treated as active.")),s.a.createElement(le.a,{variant:"primary",type:"submit",disabled:!(o.isValid&&o.dirty)||o.isSubmitting},"Save changes")))},be=te.b({username:te.c().required().min(1,"*Username must have at least 1 character").max(150,"*Username can't be longer than 100 characters").matches(/^[\w.@+-]+$/,"*Username is not valid"),password:te.c().required().min(8,"*Password must have at least 8 character").max(128,"*Password can't be longer than 128 characters").matches(/^(?=.*[A-Z])(?=.*\d)/,"*Password is not valid"),firstName:te.c().max(30,"*First name can't be longer than 30 characters"),lastName:te.c().max(150,"*Last name can't be longer than 30 characters"),isActive:te.a().required()}),Ee=function(e){var a=e.handlePostUser,t=Object(l.c)((function(e){return e.users.error})),n=Object(ae.a)({initialValues:{username:"",password:"",firstName:"",lastName:"",isActive:!1},validationSchema:be,onSubmit:function(e,n){var r=n.setSubmitting,s=n.resetForm,c=n.setStatus,u={username:e.username,password:e.password,first_name:e.firstName,last_name:e.lastName,is_active:e.isActive};Promise.resolve(a(u)).then((function(){return r(!1)})).then((function(){t||c({type:"sucess",username:e.username})})).then((function(){setTimeout((function(){s()}),2500)}))}}),r=n.status&&"sucess"===n.status.type;return s.a.createElement(s.a.Fragment,null,t&&s.a.createElement(ce.a,{variant:"danger"},t),r&&s.a.createElement(ce.a,{variant:"success"},"User ",s.a.createElement("b",null,n.status.username)," has created"),s.a.createElement(ue.a,{noValidate:!0,onSubmit:function(e){n.handleSubmit(e)}},s.a.createElement(ue.a.Group,{controlId:"username"},s.a.createElement(ue.a.Label,null,"Username"),s.a.createElement(ue.a.Control,{type:"text",placeholder:"Enter username",name:"username",onChange:n.handleChange,value:n.values.username,isInvalid:!!n.errors.username,autoFocus:!0}),s.a.createElement(ue.a.Control.Feedback,{type:"invalid"},n.errors.username)),s.a.createElement(ue.a.Group,{controlId:"password"},s.a.createElement(ue.a.Label,null,"Password"),s.a.createElement(ue.a.Control,{type:"password",placeholder:"Enter password",name:"password",onChange:n.handleChange,value:n.values.password,isInvalid:!!n.errors.password,autoFocus:!0}),s.a.createElement(ue.a.Control.Feedback,{type:"invalid"},n.errors.password)),s.a.createElement(ue.a.Group,{controlId:"firstName"},s.a.createElement(ue.a.Label,null,"First name"),s.a.createElement(ue.a.Control,{type:"text",placeholder:"Enter first name",name:"firstName",onChange:n.handleChange,value:n.values.firstName,isInvalid:!!n.errors.firstName}),s.a.createElement(ue.a.Control.Feedback,{type:"invalid"},n.errors.firstName)),s.a.createElement(ue.a.Group,{controlId:"lastName"},s.a.createElement(ue.a.Label,null,"Last name"),s.a.createElement(ue.a.Control,{type:"text",placeholder:"Enter last name",name:"lastName",onChange:n.handleChange,value:n.values.lastName,isInvalid:!!n.errors.lastName}),s.a.createElement(ue.a.Control.Feedback,{type:"invalid"},n.errors.lastName)),s.a.createElement(ue.a.Group,{controlId:"active"},s.a.createElement(ue.a.Check,{type:"checkbox",label:"Active",name:"isActive",onChange:n.handleChange,checked:n.values.isActive}),s.a.createElement(ue.a.Text,{className:"text-muted"},"Designates whether this user should be treated as active.")),s.a.createElement(le.a,{variant:"primary",type:"submit",disabled:!(n.isValid&&n.dirty)||n.isSubmitting},"Add user")))},ge=function(e){var a=e.handlePostUser,t=Object(r.useState)(!1),n=Object(me.a)(t,2),c=n[0],u=n[1],l=function(){u(!1)};return s.a.createElement(s.a.Fragment,null,s.a.createElement(le.a,{variant:"success",onClick:function(){u(!0)}},"Add User"),s.a.createElement(pe.a,{show:c,onHide:l,centered:!0},s.a.createElement(pe.a.Header,{closeButton:!0},s.a.createElement(pe.a.Title,null,"Add user")),s.a.createElement(pe.a.Body,null,s.a.createElement(Ee,{handlePostUser:a,handleClose:l})),s.a.createElement(pe.a.Footer,null,s.a.createElement(le.a,{variant:"secondary",onClick:l},"Close"))))},Ue=function(e){var a=e.user,t=e.handleDeleteUser,n=e.handlePutUser,c=e.handlePatchUser,u=Object(r.useState)(!1),l=Object(me.a)(u,2),o=l[0],i=l[1],m=function(){return i(!1)};return s.a.createElement(s.a.Fragment,null,s.a.createElement(le.a,{variant:"primary",onClick:function(){i(!0)}},"Edit"),s.a.createElement(pe.a,{show:o,onHide:m,centered:!0},s.a.createElement(pe.a.Header,{closeButton:!0},s.a.createElement(pe.a.Title,null,"Edit user")),s.a.createElement(pe.a.Body,null,s.a.createElement(ve,{user:a,handleDeleteUser:t,handlePutUser:n,handlePatchUser:c})),s.a.createElement(pe.a.Footer,null,s.a.createElement(le.a,{variant:"danger",onClick:function(){t(a.id),i(!1)},disabled:a.is_active},"Delete"),s.a.createElement(le.a,{variant:"secondary",onClick:m},"Close"))))},ye=function(e){var a=e.users,t=Object(l.b)(),n=Object(l.c)((function(e){return e.users})).usersById,r=Object(l.c)((function(e){return e.auth})).token,c=function(e){t(function(e,a){return function(){var t=Object(f.a)(p.a.mark((function t(n){var r;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,n(H()),t.next=4,k(e,a);case 4:r=t.sent,n($(r)),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),n(Q(t.t0.message));case 11:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(e){return t.apply(this,arguments)}}()}(e,r))},u=function(e,a){t(function(e,a,t){return function(){var n=Object(f.a)(p.a.mark((function n(r){var s;return p.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,r(V()),n.next=4,y(e,a,t);case 4:s=n.sent,r(D(s)),n.next=11;break;case 8:n.prev=8,n.t0=n.catch(0),r(M(n.t0.message));case 11:case"end":return n.stop()}}),n,null,[[0,8]])})));return function(e){return n.apply(this,arguments)}}()}(e,a,r))},o=function(e,a){t(function(e,a,t){return function(){var n=Object(f.a)(p.a.mark((function n(r){var s;return p.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,r(q()),n.next=4,w(e,a,t);case 4:s=n.sent,r(z(s)),n.next=11;break;case 8:n.prev=8,n.t0=n.catch(0),r(K(n.t0.message));case 11:case"end":return n.stop()}}),n,null,[[0,8]])})));return function(e){return n.apply(this,arguments)}}()}(e,a,r))};return s.a.createElement(s.a.Fragment,null,s.a.createElement("h3",{className:"align-self-center"},"Users"),s.a.createElement(ge,{handlePostUser:function(e){t(function(e,a){return function(){var t=Object(f.a)(p.a.mark((function t(n){var r;return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,n(_()),t.next=4,U(a,e);case 4:r=t.sent,n(G(r)),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),n(Z(t.t0.message));case 11:case"end":return t.stop()}}),t,null,[[0,8]])})));return function(e){return t.apply(this,arguments)}}()}(r,e))}}),s.a.createElement(de.a,{columns:[{name:"ID",sort:{enabled:!0}},"Username","First name","Last name","Last Login","Superuser status",{name:"Actions",formatter:function(e,a){var t=a.cells[0].data;return Object(de.b)(s.a.createElement(Ue,{user:n[t],handleDeleteUser:c,handlePutUser:u,handlePatchUser:o}))}}],data:a.map((function(e){return[e.id,e.username,e.first_name,e.last_name,e.last_login?(a=new Date(e.last_login),Object(he.a)(a,{addSuffix:!0})):"",e.is_superuser?"True":"False",null];var a})),search:{debounceTimeout:1e3},pagination:{enabled:!0,limit:10,summary:!1},language:{search:{placeholder:"\ud83d\udd0d\tSearch..."},pagination:{previous:"\u2b05\ufe0f",next:"\u27a1\ufe0f"}}}))},we=function(){var e=Object(l.b)(),a=Object(l.c)((function(e){return e.users})),t=a.usersById,n=a.allIds,c=Object(l.c)((function(e){return e.auth})).token,u=n.map((function(e){return t[e]}));return Object(r.useEffect)((function(){c&&e(function(e){return function(){var a=Object(f.a)(p.a.mark((function a(t){var n;return p.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.prev=0,t(T()),a.next=4,g(e);case 4:n=a.sent,t(B(n)),a.next=11;break;case 8:a.prev=8,a.t0=a.catch(0),t(J(a.t0.message));case 11:case"end":return a.stop()}}),a,null,[[0,8]])})));return function(e){return a.apply(this,arguments)}}()}(c))}),[e,c]),s.a.createElement(ne.a,{as:"section",className:"h-100 pt-3"},s.a.createElement(re.a,{className:"text-center"},s.a.createElement(ye,{users:u})))},ke=t(176),xe=t(172),Se=function(){var e=Object(l.b)(),a=Object(l.c)((function(e){return e.auth})).isAuthenticated;return s.a.createElement(s.a.Fragment,null,a&&s.a.createElement(ke.a,{bg:"light",expand:"lg"},s.a.createElement(ke.a.Brand,null,"Users CMS"),s.a.createElement(le.a,{className:"ml-auto",onClick:function(){e(O())}},"Log out")),s.a.createElement(xe.a,{fluid:!0,as:"main",className:"d-flex flex-column h-100"},s.a.createElement(ee.b,{exact:!0,path:"/"},a?s.a.createElement(we,null):s.a.createElement(ee.a,{to:"/login"})),s.a.createElement(ee.b,{exact:!0,path:"/login",component:ie})))},Ce=t(77);t(164),t(165);u.a.render(s.a.createElement(l.a,{store:Y},s.a.createElement(Ce.a,{basename:"/webim-users-task"},s.a.createElement(Se,null))),document.getElementById("root"))}},[[124,1,2]]]);
//# sourceMappingURL=main.5545f96d.chunk.js.map